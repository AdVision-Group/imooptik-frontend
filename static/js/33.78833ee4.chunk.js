(this.webpackJsonpimooptik=this.webpackJsonpimooptik||[]).push([[33],{88:function(e,t,a){"use strict";a.r(t),a.d(t,"UserContext",(function(){return O}));var n=a(2),r=a(8),s=a.n(r),c=a(12),o=a(31),i=a(13),u=a(5),p=a(1),d=a(3),l=a(20),m=a(19),f=function(e,t){var a=new Headers;a.append("auth-token",e),a.append("Content-Type","application/json");var n={method:"GET",headers:a,redirect:"follow"};return fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/admin/users/").concat(t),n)},b=function(e,t,a){var n=new Headers;n.append("auth-token",e),n.append("Content-Type","application/json");var r={method:"PATCH",headers:n,body:JSON.stringify(Object(i.a)({},t)),redirect:"follow"};return fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/admin/users/").concat(a),r)},h=function(e,t){var a=t.name,n=t.email,r=new Headers;r.append("auth-token",e),r.append("Content-Type","application/json");var s={method:"POST",headers:r,body:JSON.stringify({email:n,name:a}),redirect:"follow"};return fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/auth/register"),s)},j=function(e,t){var a=t.name,n=t.email,r=t.password,s=t.premises,c=t.admin,o=new Headers;o.append("auth-token",e),o.append("Content-Type","application/json");var i={method:"POST",headers:o,body:JSON.stringify({admin:Number(c),email:n,name:a,premises:Number(s),password:r}),redirect:"follow"};return fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/auth/register"),i)},v={address:"",admin:0,premises:0,boughtProducts:{},city:"",country:"",date:"",email:"",finishedRegistration:!1,company:{ico:"",dic:"",icdph:"",address:"",psc:"",country:""},lenses:{cylinder:[1001,1001,1001,1001],cylinderAxes:[1001,1001,1001,1001],diopters:[1001,1001,1001,1001],distance:[1001,1001,1001,1001],addition:[1001,1001,1001,1001],basis:[1001,1001,1001,1001],prism:[1001,1001,1001,1001],vys:[1001,1001,1001,1001]},name:"",orders:[],phone:"",psc:"",tempUser:!1,totalSpent:0,watchList:[],fName:"",lName:"",password:"",confirmPassword:"",birthDate:Date.now(),optometrist:!1},O=Object(p.createContext)({isUpdating:!1,activeIndex:0,handleChangeFilterItem:function(){},filterItems:[],totalCount:0,users:null,user:null,getUser:function(){},handleChange:function(){},handleParameterChange:function(){},handleCompanyChange:function(){},updateUser:function(){},resetUser:function(){},formToShow:0,switchFormButtons:[],toggleUserForm:function(){},createUser:function(){},getFilteredUsers:function(){},getUserByQuery:function(){},deleteUser:function(){}});t.default=function(e){var t=e.children,a=Object(d.h)().push,r=Object(p.useContext)(l.a).token,k=Object(p.useContext)(m.a),g=k.closeModal,w=k.getMessage,x=k.setIsLoading,y=k.setShowModal,N=Object(p.useState)(v),C=Object(u.a)(N,2),S=C[0],U=C[1],z=Object(p.useState)(null),T=Object(u.a)(z,2),P=T[0],E=T[1],F=Object(p.useState)(0),q=Object(u.a)(F,1)[0];console.count("USERCONTEXT"),console.log(S);var H=Object(p.useState)(!1),I=Object(u.a)(H,2),J=I[0],_=I[1],B=Object(p.useState)(0),D=Object(u.a)(B,2),Z=D[0],K=D[1],L=Object(p.useState)(0),M=Object(u.a)(L,2),A=M[0],Q=M[1];Object(p.useEffect)((function(){U(Object(i.a)(Object(i.a)({},S),{},{name:(null===S||void 0===S?void 0:S.fName)+" "+(null===S||void 0===S?void 0:S.lName)}))}),[null===S||void 0===S?void 0:S.fName,null===S||void 0===S?void 0:S.lName]);var R=function(){var e=Object(c.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),y(!0),_(!0),e.prev=3,e.next=6,f(r,t);case 6:return a=e.sent,e.next=9,a.json();case 9:(n=e.sent).user?(U(Object(i.a)(Object(i.a)(Object(i.a)({},S),n.user),{},{fName:n.user.name?n.user.name.split(" ")[0]:"",lName:n.user.name?n.user.name.split(" ")[1]:""})),x(!1),g()):(w(n.message),x(!1)),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),w("Nieco sa pokazilo"),x(!1);case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(c.a)(s.a.mark((function e(t,n,c,o,u,p){var d,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),y(!0),e.prev=2,e.next=5,b(r,t,n);case 5:return d=e.sent,e.next=8,d.json();case 8:if(!(l=e.sent).error){e.next=13;break}return w(l.messageSK),x(!1),e.abrupt("return");case 13:x(!1),g(),"order"===c?a("/dashboard/objednavky/".concat(n)):"profile"===c?a("/dashboard/zakaznici/".concat(n)):"isOrder"===c?(U(Object(i.a)(Object(i.a)(Object(i.a)({},t),l.user),{},{fName:l.user.name?l.user.name.split(" ")[0]:"",lName:l.user.name?l.user.name.split(" ")[1]:""})),p(Object(i.a)(Object(i.a)(Object(i.a)({},t),l.user),{},{fName:l.user.name?l.user.name.split(" ")[0]:"",lName:l.user.name?l.user.name.split(" ")[1]:""})),u()):a("/dashboard/zakaznici"),Y({filters:{admin:Z}}),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(2),console.log(e.t0),w("Nieco sa pokazilo"),x(!1);case 24:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t,a,n,r,s,c){return e.apply(this,arguments)}}(),V=function(){var e=Object(c.a)(s.a.mark((function e(t,n){var c,o,u,p,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!0),y(!0),e.prev=2,0!==A){e.next=23;break}if(c={},t._id){e.next=19;break}return e.next=8,h(r,t);case 8:return o=e.sent,e.next=11,o.json();case 11:if(!(c=e.sent).error){e.next=18;break}return w(c.message),"email"===c.type&&w("Email existuje"),"format"===c.error&&c.message.includes("email")&&w("Email musi byt platny email"),x(!1),e.abrupt("return");case 18:U(Object(i.a)(Object(i.a)({},c.user),{},{_id:c.user._id}));case 19:u=c.user?c.user._id:t._id,G(Object(i.a)({},t),u,n),e.next=41;break;case 23:if(t.password===t.confirmPassword){e.next=27;break}return w("Hesl\xe1 sa nezhoduj\xfa"),x(!1),e.abrupt("return");case 27:return e.next=29,j(r,t);case 29:return p=e.sent,e.next=32,p.json();case 32:if(!(d=e.sent).error){e.next=37;break}return w(d.message),x(!1),e.abrupt("return");case 37:x(!1),Y({filters:{admin:Z}}),a("/dashboard/zakaznici"),g();case 41:e.next=48;break;case 43:e.prev=43,e.t0=e.catch(2),console.log(e.t0),w("Nie\u010do sa pokazilo"),x(!1);case 48:case"end":return e.stop()}}),e,null,[[2,43]])})));return function(t,a){return e.apply(this,arguments)}}(),X=new Headers;X.append("auth-token",r),X.append("Content-Type","application/json");var W=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),y(!0),n={method:"DELETE",headers:X,redirect:"follow"},e.prev=3,e.next=6,fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/admin/users/").concat(t),n);case 6:return r=e.sent,e.next=9,r.json();case 9:if(!(c=e.sent).user){e.next=15;break}return a("/dashboard/zakaznici"),x(!1),g(),e.abrupt("return");case 15:w(c.messageSK),x(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(3),console.log(e.t0),w("Nie\u010do sa pokazilo"),x(!1);case 24:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(c.a)(s.a.mark((function e(t){var a,n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),y(!0),a=JSON.stringify(t),n={method:"POST",headers:X,body:a,redirect:"follow"},e.prev=4,e.next=7,fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/admin/users/filter"),n);case 7:return r=e.sent,e.next=10,r.json();case 10:if(!(c=e.sent).users){e.next=15;break}return E(c.users),g(),e.abrupt("return");case 15:w(c.messageSK),x(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(4),console.log(e.t0),w("Nieco sa pokazilo"),x(!1);case 24:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(c.a)(s.a.mark((function e(t){var a,n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),y(!0),a=JSON.stringify(t),n={method:"POST",headers:X,body:a,redirect:"follow"},e.prev=4,e.next=7,fetch("".concat("https://imooptik-backend-jbuievsjdq-ew.a.run.app","/api/admin/users/filter"),n);case 7:return r=e.sent,e.next=10,r.json();case 10:if(!(c=e.sent).users){e.next=15;break}return E(c.users),g(),e.abrupt("return");case 15:w(c.message),x(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(4),console.log(e.t0),w("Nieco sa pokazilo"),x(!1);case 24:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(O.Provider,{value:{isUpdating:J,activeIndex:Z,handleChangeFilterItem:function(e){K(e)},filterItems:[{id:0,name:"Z\xe1kazn\xedci",filter:0},{id:1,name:"Zamestnanci",filter:1},{id:2,name:"Ved\xfaci",filter:2}],users:P,user:S,totalCount:q,getUser:R,handleChange:function(e){var t=e.target,a=t.name,n=t.value;U(Object(i.a)(Object(i.a)({},S),{},Object(o.a)({},a,n)))},handleParameterChange:function(e,t){var a=e.target,n=a.name,r=a.value,s=S.lenses[n];s[t]=""===r?1001:r,U(Object(i.a)(Object(i.a)({},S),{},{lenses:Object(i.a)(Object(i.a)({},S.lenses),{},Object(o.a)({},n,s))}))},handleCompanyChange:function(e){var t=e.target,a=t.name,n=t.value;U(Object(i.a)(Object(i.a)({},S),{},{company:Object(i.a)(Object(i.a)({},S.company),{},Object(o.a)({},a,n))}))},updateUser:G,resetUser:function(){U(v),_(!1),Q(0)},formToShow:A,switchFormButtons:[{name:"Z\xe1kazn\xedk"},{name:"Zamestnanec"}],toggleUserForm:function(e,t){e.preventDefault(),Q(t)},createUser:V,getFilteredUsers:Y,getUserByQuery:$,deleteUser:W},children:t})}}}]);
//# sourceMappingURL=33.78833ee4.chunk.js.map