{"version":3,"sources":["context/blog/blog.queries.jsx","context/blog/blog.context.jsx"],"names":["fetchSinglePost","id","fetch","process","deletePost","token","myHeaders","Headers","append","requestOptions","method","headers","redirect","BlogContext","createContext","posts","post","postsCount","getPosts","createPost","getPost","updatePost","handlePostDelete","resetBlog","BlogProvider","children","useContext","AuthContext","LoadingModalContext","getMessage","setIsLoading","setShowModal","useState","setPosts","setPost","setPostsCount","a","response","json","data","blogs","count","blog","message","console","log","postObj","callback","raw","JSON","stringify","body","messageSK","blogId","postResponse","postData","Provider","value"],"mappings":"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","file":"static/js/29.72783c5e.chunk.js","sourcesContent":["\n\nexport const fetchPosts = () => {\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/blogs`)\n}\n\nexport const fetchSinglePost = (id) => {\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/blogs/${id}`)\n}\n\nexport const createNewPost = (token, name, description, draft, html, img) => {\n    const myHeaders = new Headers();\n    myHeaders.append(\"auth-token\", token);\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    const raw = JSON.stringify({ \"name\": name, \"description\": description, \"draft\": draft, \"html\": html, 'image': img });\n\n    const requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: raw,\n        redirect: 'follow'\n    };\n\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs`, requestOptions)\n}\n\nexport const updatePost = (token, name, description, draft, html, img, id) => {\n    const myHeaders = new Headers();\n    myHeaders.append(\"auth-token\", token);\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    const raw = JSON.stringify({ \"name\": name, \"description\": description, \"draft\": draft, \"html\": html, 'image': img });\n\n    const requestOptions = {\n        method: 'PATCH',\n        headers: myHeaders,\n        body: raw,\n        redirect: 'follow'\n    };\n\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs/${id}`, requestOptions)\n\n}\n\nexport const deletePost = (token, id) => {\n    const myHeaders = new Headers();\n    myHeaders.append(\"auth-token\", token);\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n\n    const requestOptions = {\n        method: 'DELETE',\n        headers: myHeaders,\n        redirect: 'follow'\n    };\n\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs/${id}`, requestOptions)\n\n}\n\n","import React, { createContext, useState, useContext } from 'react'\nimport { AuthContext } from '../auth/auth.context'\nimport { LoadingModalContext } from '../loading-modal/loading-modal.contenxt'\nimport {\n    fetchPosts,\n    // createNewPost,\n    fetchSinglePost,\n    // updatePost,\n    deletePost,\n} from './blog.queries'\n\n\nexport const BlogContext = createContext({\n    posts: null,\n    post: null,\n    postsCount: 0,\n    getPosts: () => { },\n    createPost: () => { },\n    getPost: () => { },\n    updatePost: () => { },\n    handlePostDelete: () => { },\n    resetBlog: () => { }\n})\n\nconst BlogProvider = ({ children }) => {\n    const { token } = useContext(AuthContext)\n\n    const {\n        getMessage,\n        setIsLoading,\n        setShowModal\n    } = useContext(LoadingModalContext)\n\n    const [posts, setPosts] = useState(null)\n    const [post, setPost] = useState(null)\n    const [postsCount, setPostsCount] = useState(0)\n\n    const myHeaders = new Headers();\n    myHeaders.append(\"auth-token\", token);\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    const getPosts = async () => {\n        setShowModal(true)\n        setIsLoading(true)\n\n        const response = await fetchPosts()\n        const data = await response.json()\n\n        setPosts(data.blogs)\n        setPostsCount(data.count)\n\n        setShowModal(false)\n        setIsLoading(false)\n    }\n\n    const getPost = async (id) => {\n        setShowModal(true)\n        setIsLoading(true)\n\n        try {\n\n            const response = await fetchSinglePost(id)\n            const data = await response.json()\n\n            if (data.blog) {\n                setPost(data.blog)\n                setIsLoading(false)\n                getMessage(data.message)\n                return\n            }\n\n            setIsLoading(false)\n            getMessage(data.message)\n            // setPosts(data.blogs)\n            // setPostsCount(data.count)\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n\n\n        setShowModal(false)\n        setIsLoading(false)\n    }\n\n    const createPost = async (postObj, callback = () => {}) => {\n        setShowModal(true)\n        setIsLoading(true)\n\n        const raw = JSON.stringify(postObj);\n\n        const requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: raw,\n            redirect: 'follow'\n        };\n    \n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs`, requestOptions)\n            const data = await response.json()\n            // const postResponse = await createNewPost(token, name, description, draft, html, img)\n            // const postData = await postResponse.json()\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n            callback(data)\n            getPosts()\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Niečo sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    const updatePost = async (postObj, blogId, callback = () => {}) => {\n        setShowModal(true)\n        setIsLoading(true)\n\n        const raw = JSON.stringify(postObj);\n\n        const requestOptions = {\n            method: 'PATCH',\n            headers: myHeaders,\n            body: raw,\n            redirect: 'follow'\n        };\n\n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs/${blogId}`, requestOptions)\n            const data = await response.json()\n            // const postResponse = await updatePost(token, name, description, draft, html, img, id)\n            // const postData = await postResponse.json()\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n            callback(data)\n            getPosts()\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Niečo sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    const handlePostDelete = async (id) => {\n        setShowModal(true)\n        setIsLoading(true)\n\n        try {\n            const postResponse = await deletePost(token, id)\n            const postData = await postResponse.json()\n\n            getMessage(postData.message)\n            setIsLoading(false)\n            getPosts()\n\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    const resetBlog = () => {\n        setPost(null)\n    }\n\n    return (\n        <BlogContext.Provider\n            value={{\n                posts,\n                post,\n                postsCount,\n                getPosts,\n                createPost,\n                getPost,\n                updatePost,\n                handlePostDelete,\n                resetBlog,\n            }}\n        >\n            {children}\n        </BlogContext.Provider>\n    )\n}\n\nexport default BlogProvider"],"sourceRoot":""}