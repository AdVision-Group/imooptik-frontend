(this.webpackJsonpimooptik=this.webpackJsonpimooptik||[]).push([[31],{73:function(e,t,n){"use strict";n.r(t),n.d(t,"OrdersContext",(function(){return f}));var r=n(2),o=n(21),a=n(7),c=n.n(a),s=n(12),i=n(10),u=n(1),l=n(3),p=n(18),d=n(19),f=Object(u.createContext)({orders:null,getPDF:function(){},getOrders:function(){},createOrder:function(){},updateOrder:function(){},finishOrder:function(){},cancelOrder:function(){}});t.default=function(e){var t=e.children,n=Object(l.h)().push,a=Object(u.useContext)(d.a),h=a.setIsLoading,v=a.setShowModal,b=a.getMessage,O=a.closeModal,g=Object(u.useContext)(p.a).token,m=Object(u.useState)(null),x=Object(i.a)(m,2),k=x[0],j=x[1],w=new Headers;w.append("auth-token",g),w.append("Content-Type","application/json");var S=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),t={method:"GET",headers:w,redirect:"follow"},e.prev=3,e.next=6,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders"),t);case 6:return n=e.sent,e.next=9,n.json();case 9:if(r=e.sent,console.log(r),!r.orders){e.next=15;break}return j(r.orders),O(),e.abrupt("return");case 15:b(r.messageSK),h(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(3),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 24:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),n={method:"POST",headers:w,redirect:"follow"},e.prev=3,e.next=6,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders/").concat(t,"/createPdf"),n);case 6:return r=e.sent,e.next=9,r.json();case 9:o=e.sent,console.log(o),o.filename&&(h(!1),b(o.messageSK),setTimeout((function(){var e=window.open("".concat("http://195.110.58.166:8080","/uploads/pdf/").concat(o.filename),"_blank","noreferrer noopener");null===e||void 0===e||e.focus()}),100)),b(o.messageSK),h(!1),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(3),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(c.a.mark((function e(t){var r,a,s,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),r=Object(o.a)({},t),console.log("ORDER BEFORE SEND"),console.log(r),a=JSON.stringify(r),s={method:"POST",headers:w,body:a,redirect:"follow"},e.prev=7,e.next=10,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders"),s);case 10:return i=e.sent,e.next=13,i.json();case 13:u=e.sent,console.log(u),u.order&&(S(),O(),n("/dashboard/objednavky"),setTimeout((function(){y(u.order._id)}),100)),b(u.messageSK),h(!1),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(7),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 25:case"end":return e.stop()}}),e,null,[[7,20]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(s.a)(c.a.mark((function e(t,r){var a,s,i,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),a=Object(o.a)({},t),console.log("ORDER BEFORE SEND"),console.log(a),s=JSON.stringify(a),i={method:"PATCH",headers:w,body:s,redirect:"follow"},e.prev=7,e.next=10,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders/").concat(r),i);case 10:return u=e.sent,e.next=13,u.json();case 13:l=e.sent,console.log(l),l.order&&(S(),O(),n("/dashboard/objednavky")),b(l.messageSK),h(!1),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(7),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 25:case"end":return e.stop()}}),e,null,[[7,20]])})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(c.a.mark((function e(t,n){var r,o,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),r={method:"POST",headers:w,redirect:"follow"},e.prev=3,e.next=6,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders/").concat(t,"/fulfill"),r);case 6:return o=e.sent,e.next=9,o.json();case 9:if(a=e.sent,console.log(a),!a.order){e.next=15;break}return n(),O(),e.abrupt("return");case 15:b(a.messageSK),h(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(3),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 24:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t,n){return e.apply(this,arguments)}}(),P=function(){var e=Object(s.a)(c.a.mark((function e(t,n){var r,o,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),v(!0),r={method:"POST",headers:w,redirect:"follow"},e.prev=3,e.next=6,fetch("".concat("http://195.110.58.166:8080","/api/admin/orders/").concat(t,"/cancel"),r);case 6:return o=e.sent,e.next=9,o.json();case 9:if(a=e.sent,console.log(a),!a.order){e.next=14;break}return setTimeout((function(){n(),O()}),100),e.abrupt("return");case 14:b(a.messageSK),h(!1),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(3),console.log(e.t0),b("Nieco sa pokazilo"),h(!1);case 23:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.jsx)(f.Provider,{value:{orders:k,getPDF:y,getOrders:S,createOrder:N,updateOrder:T,finishOrder:E,cancelOrder:P},children:t})}}}]);
//# sourceMappingURL=31.ccd7e113.chunk.js.map