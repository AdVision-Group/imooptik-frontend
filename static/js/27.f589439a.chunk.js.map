{"version":3,"sources":["context/blog/blog.queries.jsx","context/blog/blog.context.jsx"],"names":["fetchSinglePost","id","fetch","process","createNewPost","token","name","description","draft","html","img","myHeaders","Headers","append","requestOptions","method","headers","body","JSON","stringify","redirect","updatePost","deletePost","BlogContext","createContext","posts","post","postsCount","getPosts","createPost","getPost","handlePostUpdate","handlePostDelete","resetBlog","BlogProvider","children","useContext","AuthContext","LoadingModalContext","getMessage","setIsLoading","setShowModal","useState","setPosts","setPost","setPostsCount","a","response","json","data","blogs","count","blog","message","console","log","postResponse","postData","Provider","value"],"mappings":"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","file":"static/js/27.f589439a.chunk.js","sourcesContent":["\r\n\r\nexport const fetchPosts = () => {\r\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/blogs`)\r\n}\r\n\r\nexport const fetchSinglePost = (id) => {\r\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/blogs/${id}`)\r\n}\r\n\r\nexport const createNewPost = (token, name, description, draft, html, img) => {\r\n    const myHeaders = new Headers();\r\n    myHeaders.append(\"auth-token\", token);\r\n    myHeaders.append(\"Content-Type\", \"application/json\");\r\n\r\n    const raw = JSON.stringify({ \"name\": name, \"description\": description, \"draft\": draft, \"html\": html, 'image': img });\r\n\r\n    const requestOptions = {\r\n        method: 'POST',\r\n        headers: myHeaders,\r\n        body: raw,\r\n        redirect: 'follow'\r\n    };\r\n\r\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs`, requestOptions)\r\n}\r\n\r\nexport const updatePost = (token, name, description, draft, html, img, id) => {\r\n    const myHeaders = new Headers();\r\n    myHeaders.append(\"auth-token\", token);\r\n    myHeaders.append(\"Content-Type\", \"application/json\");\r\n\r\n    const raw = JSON.stringify({ \"name\": name, \"description\": description, \"draft\": draft, \"html\": html, 'image': img });\r\n\r\n    const requestOptions = {\r\n        method: 'PATCH',\r\n        headers: myHeaders,\r\n        body: raw,\r\n        redirect: 'follow'\r\n    };\r\n\r\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs/${id}`, requestOptions)\r\n\r\n}\r\n\r\nexport const deletePost = (token, id) => {\r\n    const myHeaders = new Headers();\r\n    myHeaders.append(\"auth-token\", token);\r\n    myHeaders.append(\"Content-Type\", \"application/json\");\r\n\r\n\r\n    const requestOptions = {\r\n        method: 'DELETE',\r\n        headers: myHeaders,\r\n        redirect: 'follow'\r\n    };\r\n\r\n    return fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/blogs/${id}`, requestOptions)\r\n\r\n}\r\n\r\n","import React, { createContext, useState, useContext } from 'react'\r\nimport { AuthContext } from '../auth/auth.context'\r\nimport { LoadingModalContext } from '../loading-modal/loading-modal.contenxt'\r\nimport {\r\n    fetchPosts,\r\n    createNewPost,\r\n    fetchSinglePost,\r\n    updatePost,\r\n    deletePost,\r\n} from './blog.queries'\r\n\r\n\r\nexport const BlogContext = createContext({\r\n    posts: null,\r\n    post: null,\r\n    postsCount: 0,\r\n    getPosts: () => { },\r\n    createPost: () => { },\r\n    getPost: () => { },\r\n    handlePostUpdate: () => { },\r\n    handlePostDelete: () => { },\r\n    resetBlog: () => { }\r\n})\r\n\r\nconst BlogProvider = ({ children }) => {\r\n    const { token } = useContext(AuthContext)\r\n\r\n    const {\r\n        getMessage,\r\n        setIsLoading,\r\n        setShowModal\r\n    } = useContext(LoadingModalContext)\r\n\r\n    const [posts, setPosts] = useState(null)\r\n    const [post, setPost] = useState(null)\r\n    const [postsCount, setPostsCount] = useState(0)\r\n\r\n    const getPosts = async () => {\r\n        setShowModal(true)\r\n        setIsLoading(true)\r\n\r\n        const response = await fetchPosts()\r\n        const data = await response.json()\r\n\r\n        setPosts(data.blogs)\r\n        setPostsCount(data.count)\r\n\r\n        setShowModal(false)\r\n        setIsLoading(false)\r\n    }\r\n\r\n    const getPost = async (id) => {\r\n        setShowModal(true)\r\n        setIsLoading(true)\r\n\r\n        try {\r\n\r\n            const response = await fetchSinglePost(id)\r\n            const data = await response.json()\r\n\r\n            if (data.blog) {\r\n                setPost(data.blog)\r\n                setIsLoading(false)\r\n                getMessage(data.message)\r\n                return\r\n            }\r\n\r\n            setIsLoading(false)\r\n            getMessage(data.message)\r\n            // setPosts(data.blogs)\r\n            // setPostsCount(data.count)\r\n        } catch (err) {\r\n            console.log(err)\r\n            getMessage(\"Nieco sa pokazilo\")\r\n            setIsLoading(false)\r\n        }\r\n\r\n\r\n        setShowModal(false)\r\n        setIsLoading(false)\r\n    }\r\n\r\n    const createPost = async (img, name, description, draft, html) => {\r\n        setShowModal(true)\r\n        setIsLoading(true)\r\n\r\n        try {\r\n            const postResponse = await createNewPost(token, name, description, draft, html, img)\r\n            const postData = await postResponse.json()\r\n\r\n            getMessage(postData.message)\r\n            setIsLoading(false)\r\n            getPosts()\r\n        } catch (err) {\r\n            console.log(err)\r\n            getMessage(\"Nieco sa pokazilo\")\r\n            setIsLoading(false)\r\n        }\r\n    }\r\n\r\n    const handlePostUpdate = async (name, description, draft, html, img, id) => {\r\n        setShowModal(true)\r\n        setIsLoading(true)\r\n\r\n        try {\r\n            const postResponse = await updatePost(token, name, description, draft, html, img, id)\r\n            const postData = await postResponse.json()\r\n\r\n            getMessage(postData.message)\r\n            setIsLoading(false)\r\n            getPosts()\r\n        } catch (err) {\r\n            console.log(err)\r\n            getMessage(\"Nieco sa pokazilo\")\r\n            setIsLoading(false)\r\n        }\r\n    }\r\n\r\n    const handlePostDelete = async (id) => {\r\n        setShowModal(true)\r\n        setIsLoading(true)\r\n\r\n        try {\r\n            const postResponse = await deletePost(token, id)\r\n            const postData = await postResponse.json()\r\n\r\n            getMessage(postData.message)\r\n            setIsLoading(false)\r\n            getPosts()\r\n\r\n        } catch (err) {\r\n            console.log(err)\r\n            getMessage(\"Nieco sa pokazilo\")\r\n            setIsLoading(false)\r\n        }\r\n    }\r\n\r\n    const resetBlog = () => {\r\n        setPost(null)\r\n    }\r\n\r\n    return (\r\n        <BlogContext.Provider\r\n            value={{\r\n                posts,\r\n                post,\r\n                postsCount,\r\n                getPosts,\r\n                createPost,\r\n                getPost,\r\n                handlePostUpdate,\r\n                handlePostDelete,\r\n                resetBlog,\r\n            }}\r\n        >\r\n            {children}\r\n        </BlogContext.Provider>\r\n    )\r\n}\r\n\r\nexport default BlogProvider"],"sourceRoot":""}