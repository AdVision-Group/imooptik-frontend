{"version":3,"sources":["context/orders/orders.context.jsx"],"names":["OrdersContext","createContext","orders","getOrders","createOrder","updateOrder","finishOrder","OrdersProvider","children","push","useHistory","useContext","LoadingModalContext","setIsLoading","setShowModal","getMessage","closeModal","token","AuthContext","useState","setOrders","myHeaders","Headers","append","a","requestOptions","method","headers","redirect","fetch","process","response","json","data","console","log","messageSK","orderToCreate","orderObj","raw","JSON","stringify","body","order","orderToUpdate","orderId","Provider","value"],"mappings":"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","file":"static/js/29.ae27763a.chunk.js","sourcesContent":["import React, { createContext, useState, useContext } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { AuthContext } from '../auth/auth.context'\nimport { LoadingModalContext } from '../loading-modal/loading-modal.contenxt'\n\n\nexport const OrdersContext = createContext({\n    orders: null,\n    getOrders: () => { },\n    createOrder: () => { },\n    updateOrder: () => { },\n    finishOrder: () => { },\n})\n\nconst OrdersProvider = ({ children }) => {\n    const { push } = useHistory()\n    const { setIsLoading, setShowModal, getMessage, closeModal } = useContext(LoadingModalContext)\n    const { token } = useContext(AuthContext)\n    const [orders, setOrders] = useState(null)\n\n\n\n\n\n\n\n    // REQUESTS\n\n    const myHeaders = new Headers();\n    myHeaders.append(\"auth-token\", token);\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    const getOrders = async () => {\n        setIsLoading(true)\n        setShowModal(true)\n\n        const requestOptions = {\n            method: 'GET',\n            headers: myHeaders,\n            redirect: 'follow'\n        };\n\n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/orders`, requestOptions)\n            const data = await response.json()\n\n            console.log(data)\n\n            if (data.orders) {\n                setOrders(data.orders)\n                closeModal()\n                return\n            }\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n\n    }\n\n    const createOrder = async (orderToCreate) => {\n        setIsLoading(true)\n        setShowModal(true)\n\n        let orderObj = {\n            ...orderToCreate\n        }\n\n\n        console.log(\"ORDER BEFORE SEND\")\n        console.log(orderObj)\n\n        const raw = JSON.stringify(orderObj)\n\n        const requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: raw,\n            redirect: 'follow'\n        };\n\n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/orders`, requestOptions)\n            const data = await response.json()\n\n            console.log(data)\n\n            if (data.order) {\n                getOrders()\n                closeModal()\n                push('/dashboard/objednavky')\n            }\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    const updateOrder = async (orderToUpdate, orderId) => {\n        setIsLoading(true)\n        setShowModal(true)\n\n        let orderObj = {\n            ...orderToUpdate\n        }\n\n\n        console.log(\"ORDER BEFORE SEND\")\n        console.log(orderObj)\n\n        const raw = JSON.stringify(orderObj)\n\n        const requestOptions = {\n            method: 'PATCH',\n            headers: myHeaders,\n            body: raw,\n            redirect: 'follow'\n        };\n\n\n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/orders/${orderId}`, requestOptions)\n            const data = await response.json()\n\n            console.log(data)\n\n            if (data.order) {\n                getOrders()\n                closeModal()\n                push('/dashboard/objednavky')\n            }\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    const finishOrder = async (orderId) => {\n        setIsLoading(true)\n        setShowModal(true)\n\n        const requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            redirect: 'follow'\n        };\n\n        try {\n            const response = await fetch(`${process.env.REACT_APP_BACKEND_ENDPOINT}/api/admin/orders/${orderId}/fulfill`, requestOptions)\n            const data = await response.json()\n\n            console.log(data)\n\n            if (data.order) {\n                closeModal()\n                return\n            }\n\n            getMessage(data.messageSK)\n            setIsLoading(false)\n        } catch (err) {\n            console.log(err)\n            getMessage(\"Nieco sa pokazilo\")\n            setIsLoading(false)\n        }\n    }\n\n    return (\n        <OrdersContext.Provider\n            value={{\n                orders,\n                getOrders,\n                createOrder,\n                updateOrder,\n                finishOrder\n            }}\n        >\n            {children}\n        </OrdersContext.Provider>\n    )\n}\n\nexport default OrdersProvider"],"sourceRoot":""}